Starting end-to-end LLM conversation test...
This will make REAL API calls and use tokens.

======================================================================
CITE-AGENT END-TO-END LLM CONVERSATION TEST
Date: 2025-11-17T02:25:48.724824
======================================================================

ğŸš€ Initializing agent...
ğŸ” _load_authentication: USE_LOCAL_KEYS=true, use_local_keys=True
ğŸ” _load_authentication: session_file exists=True
ğŸ” _load_authentication: loaded auth_token=True, user_id=SnIps5WLI9szzcgoQ7LqHA
âš ï¸ Using demo API key
âœ… API clients initialized (Archive=https://cite-agent-api-720dfadd602c.herokuapp.com/api, FinSight=https://cite-agent-api-720dfadd602c.herokuapp.com/v1/finance)
âš ï¸ Using demo API key
âœ… API clients initialized (Archive=https://cite-agent-api-720dfadd602c.herokuapp.com/api, FinSight=https://cite-agent-api-720dfadd602c.herokuapp.com/v1/finance)
ğŸ” DEBUG: Taking LOCAL MODE path (use_local_keys=True)
âœ… Loaded 1 CEREBRAS API key(s)
ğŸ” DEBUG: has_both_tokens check - temp_api_key=False, auth_token=False, use_local_keys_explicit=True
ğŸ” DEBUG: Initializing CEREBRAS client with API key
âœ… Initialized CEREBRAS client for LOCAL MODE
ğŸ” DEBUG: self.client is now: <class 'openai.OpenAI'>
âœ… Agent initialized
   LLM Provider: cerebras
   Model: gpt-oss-120b

======================================================================
RUNNING CONVERSATION TESTS
======================================================================

======================================================================
TEST 1: Simple File Listing
======================================================================
Query: what files are here?
Expected: Should call list_directory() to show files

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: what files are here?...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: what files are here?...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8
   âš ï¸  Expected tool 'list_directory' NOT called
      Got: ['chat']

======================================================================
TEST 2: Conversational Query
======================================================================
Query: thanks for that
Expected: Should respond conversationally without file ops

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: thanks for that...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: thanks for that...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8
   âœ… Expected tool 'chat' was called

======================================================================
TEST 3: Fuzzy Query - Find Data
======================================================================
Query: I think there's some CSV data around here somewhere, can you check?
Expected: Should browse and identify CSV files intelligently

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: I think there's some CSV data around here somewhere, can you check?...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: I think there's some CSV data around here somewhere, can you check?...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8
   âš ï¸  Expected tool 'list_directory' NOT called
      Got: ['chat']

======================================================================
TEST 4: Load Dataset
======================================================================
Query: load the ivol_summary_results.csv file
Expected: Should load CSV and compute statistics

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: load the ivol_summary_results.csv file...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: load the ivol_summary_results.csv file...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8
   âš ï¸  Expected tool 'load_dataset' NOT called
      Got: ['chat']

======================================================================
TEST 5: Statistics Query
======================================================================
Query: what's the mean spread?
Expected: Should report statistics from loaded data

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: what's the mean spread?...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: what's the mean spread?...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8

======================================================================
TEST 6: Academic Paper Search
======================================================================
Query: find papers on transformer neural networks
Expected: Should search academic databases

ğŸ” ROUTING: Using FUNCTION CALLING mode
ğŸ” [Function Calling] Processing query: find papers on transformer neural networks...
ğŸ” [Function Calling] Iteration 1/3
ğŸ” [Function Calling] Sending query to cerebras: find papers on transformer neural networks...
ğŸ” [Function Calling] Calling cerebras with model gpt-oss-120b
âš ï¸ [Function Calling] cerebras rate limited (429)
ğŸ” [Function Calling] No tool calls in iteration 1
ğŸ“¥ Response (84 chars):
--------------------------------------------------
The AI service is experiencing high traffic right now. Please try again in a moment.
--------------------------------------------------

ğŸ“Š Metrics:
   Tools used: ['chat']
   Tokens used: 0
   Confidence: 0.8
   âš ï¸  Expected tool 'search_papers' NOT called
      Got: ['chat']

======================================================================
SAVING CONVERSATION LOG
======================================================================
âœ… Saved to conversation_test_results.json

======================================================================
TEST SUMMARY
======================================================================
Tests run: 6
Successful: 6
Failed: 0
Total tokens used: 0
Estimated cost: $0.000000

ğŸ“‹ Key Behaviors:
   Tools called: chat

âœ… Agent closed

âœ… Test complete. Check conversation_test_results.json for full log.
